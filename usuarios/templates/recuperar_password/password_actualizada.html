{% extends 'master.html' %}
{% load static %}
{% block title %}Contraseña Actualizada · Arte & Estilos{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'usuarios/css/styles.css' %}">
{% endblock %}

{% block content %}
<!-- ========================================================================== -->
<!-- FONDO ANIMADO DE 4 IMÁGENES (SLIDESHOW) -->
<!-- ========================================================================== -->
<div id="bg-slideshow" aria-hidden="true">
  <div class="slide" style="--i:0; --img: url('{% static 'usuarios/img/1_FondoRegistro.png' %}');"></div>
  <div class="slide" style="--i:1; --img: url('{% static 'usuarios/img/2_FondoRegistro.png' %}');"></div>
  <div class="slide" style="--i:2; --img: url('{% static 'usuarios/img/3_FondoRegistro.png' %}');"></div>
  <div class="slide" style="--i:3; --img: url('{% static 'usuarios/img/4_FondoRegistro.png' %}');"></div>
</div>

<!-- ========================================================================== -->
<!-- SECCIÓN DE CONFIRMACIÓN DE ÉXITO -->
<!-- ========================================================================== -->
<section class="login-page py-5" role="main">
  <div class="container login-container">
    <div class="row justify-content-center">
      <div class="col-md-7 col-lg-6 col-xl-5">
        <div class="login-card glassy text-center">

          <!-- ================================================================ -->
          <!-- ÍCONO DE ÉXITO CON ANIMACIÓN -->
          <!-- ================================================================ -->
          <div class="mb-4">
            <div class="position-relative d-inline-block mb-3">
              <i class="bi bi-check-circle-fill d-block animate-success" style="font-size:72px;color:#28a745;" aria-hidden="true"></i>
            </div>
            <h1 class="login-title h2 mb-2 text-success">¡Contraseña Actualizada!</h1>
            <p class="text-muted">Tu contraseña ha sido cambiada exitosamente</p>
          </div>

          <!-- ================================================================ -->
          <!-- MENSAJE INFORMATIVO -->
          <!-- ================================================================ -->
          <div class="alert alert-success d-flex align-items-start text-start mb-4" role="alert">
            <i class="bi bi-check2-circle me-2 mt-1 fs-5" aria-hidden="true"></i>
            <div>
              <strong>¿Qué hacer ahora?</strong>
              <ul class="mb-0 mt-2 small ps-3">
                <li>Ya puedes iniciar sesión con tu <strong>nueva contraseña</strong></li>
                <li>Asegúrate de <strong>recordar tu contraseña</strong></li>
                <li>Considera usar un <strong>gestor de contraseñas</strong> seguro</li>
                <li>Nunca compartas tu contraseña con nadie</li>
              </ul>
            </div>
          </div>

          <!-- ================================================================ -->
          <!-- MENSAJE DE SEGURIDAD -->
          <!-- ================================================================ -->
          <div class="alert alert-warning d-flex align-items-start text-start mb-4" role="alert">
            <i class="bi bi-shield-lock-fill me-2 mt-1 fs-5" aria-hidden="true"></i>
            <div>
              <strong>Recomendación de seguridad</strong>
              <p class="mb-0 mt-1 small">
                Si no realizaste este cambio, contacta inmediatamente a nuestro equipo de soporte.
                Tu cuenta podría estar comprometida.
              </p>
            </div>
          </div>

          <!-- ================================================================ -->
          <!-- BOTÓN DE ACCIÓN PRINCIPAL -->
          <!-- ================================================================ -->
          <div class="d-grid gap-2 mb-3">
            <a href="{% url 'usuarios:login' %}" class="btn btn-login btn-lg" id="btnLogin">
              <i class="bi bi-box-arrow-in-right me-2" aria-hidden="true"></i>
              <span>Iniciar sesión ahora</span>
            </a>
          </div>

          <!-- ================================================================ -->
          <!-- CONTADOR DE REDIRECCIÓN AUTOMÁTICA -->
          <!-- ================================================================ -->
          <div class="text-center">
            <small class="text-muted">
              <i class="bi bi-clock me-1"></i>
              Serás redirigido al login en <strong><span id="countdown">10</span> segundos</strong>
            </small>
          </div>

        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
  // Animación del ícono de éxito
  const style = document.createElement('style');
  style.textContent = `
    @keyframes pulse-success {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    .animate-success {
      animation: pulse-success 2s ease-in-out infinite;
    }
  `;
  document.head.appendChild(style);

  // Contador regresivo y redirección automática
  let seconds = 10;
  const countdownEl = document.getElementById('countdown');
  const loginUrl = "{% url 'usuarios:login' %}";

  const interval = setInterval(() => {
    seconds--;
    if (countdownEl) {
      countdownEl.textContent = seconds;
    }

    if (seconds <= 0) {
      clearInterval(interval);
      window.location.href = loginUrl;
    }
  }, 1000);

  // Detener el contador si el usuario hace clic en el botón
  document.getElementById('btnLogin')?.addEventListener('click', () => {
    clearInterval(interval);
  });
</script>
{% endblock %}
