{% extends 'core/panel_admin_base.html' %}
{% load static %}

{% block title %}Ver Usuario - {{ usuario.username }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'usuarios/css/admin_usuarios.css' %}">
{% endblock %}

{% block content %}
<div class="container-fluid py-5">
    <!-- Breadcrumb -->
    <div class="page-breadcrumb mb-4">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb mb-0">
                <li class="breadcrumb-item">
                    <a href="{% url 'core:dashboard' %}">
                        <i class="bi bi-house-door-fill"></i>
                        <span>Inicio</span>
                    </a>
                </li>
                <li class="breadcrumb-item">
                    <a href="{% url 'usuarios:lista_usuarios' %}">
                        <i class="bi bi-people-fill"></i>
                        <span>Usuarios</span>
                    </a>
                </li>
                <li class="breadcrumb-item active" aria-current="page">
                    {{ usuario.username }}
                </li>
            </ol>
        </nav>
    </div>

    <div class="row justify-content-center">
        <div class="col-lg-10 col-xl-8">

            <!-- Header del Perfil -->
            <div class="profile-header-card">
                <div class="profile-header-content">
                    <div class="profile-avatar-wrapper">
                        {% if usuario.perfil.foto_perfil %}
                            <img src="{{ usuario.perfil.foto_perfil.url }}" alt="{{ usuario.get_full_name }}" class="profile-avatar">
                        {% else %}
                            <div class="profile-avatar-placeholder">
                                <span>{{ usuario.first_name.0 }}{{ usuario.last_name.0 }}</span>
                            </div>
                        {% endif %}
                        {% if usuario.is_active %}
                        <div class="profile-status-indicator"></div>
                        {% endif %}
                    </div>

                    <div class="profile-header-info">
                        <h1 class="profile-name">{{ usuario.get_full_name|default:usuario.username }}</h1>
                        <p class="profile-username">@{{ usuario.username }}</p>
                        <div class="profile-badges">
                            {% if usuario.is_superuser %}
                                <span class="profile-badge badge-admin">
                                    <i class="bi bi-shield-fill-check"></i> Superadministrador
                                </span>
                            {% elif usuario.is_staff %}
                                <span class="profile-badge badge-staff">
                                    <i class="bi bi-person-badge-fill"></i> Administrador
                                </span>
                            {% else %}
                                <span class="profile-badge badge-user">
                                    <i class="bi bi-person-fill"></i> Usuario
                                </span>
                            {% endif %}

                            {% if usuario.is_active %}
                                <span class="profile-badge badge-active">
                                    <i class="bi bi-check-circle-fill"></i> Activo
                                </span>
                            {% else %}
                                <span class="profile-badge badge-inactive">
                                    <i class="bi bi-x-circle-fill"></i> Inactivo
                                </span>
                            {% endif %}
                        </div>
                    </div>

                    {% if es_propio_perfil %}
                    <div class="profile-header-actions">
                        <a href="{% url 'usuarios:editar_usuario' usuario.id %}" class="profile-action-btn btn-edit">
                            <i class="bi bi-pencil-square"></i>
                            <span>Editar</span>
                        </a>
                    </div>
                    {% else %}
                    <div class="profile-header-actions">
                        <span class="badge-readonly" style="padding: 0.75rem 1.25rem;">
                            <i class="bi bi-lock-fill"></i>
                            <span>Solo lectura</span>
                        </span>
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Información de Contacto -->
            <div class="profile-info-card">
                <h2 class="profile-info-title">
                    <i class="bi bi-envelope-fill"></i>
                    Información de Contacto
                </h2>
                <div class="profile-info-grid">
                    <div class="profile-info-item">
                        <span class="profile-info-label">Correo Electrónico</span>
                        <span class="profile-info-value">
                            <i class="bi bi-envelope me-2"></i>
                            {{ usuario.email }}
                        </span>
                    </div>
                    <div class="profile-info-item">
                        <span class="profile-info-label">Teléfono</span>
                        <span class="profile-info-value">
                            <i class="bi bi-telephone me-2"></i>
                            {{ perfil.telefono|default:"No especificado" }}
                        </span>
                    </div>
                    <div class="profile-info-item">
                        <span class="profile-info-label">Dirección</span>
                        <span class="profile-info-value">
                            <i class="bi bi-geo-alt me-2"></i>
                            {{ perfil.direccion|default:"No especificada" }}
                        </span>
                    </div>
                </div>
            </div>

            <!-- Información Personal -->
            <div class="profile-info-card">
                <h2 class="profile-info-title">
                    <i class="bi bi-person-fill"></i>
                    Información Personal
                </h2>
                <div class="profile-info-grid">
                    <div class="profile-info-item">
                        <span class="profile-info-label">Documento</span>
                        <span class="profile-info-value">{{ usuario.documento }}</span>
                    </div>
                    <div class="profile-info-item">
                        <span class="profile-info-label">Fecha de Nacimiento</span>
                        <span class="profile-info-value">
                            {{ perfil.fecha_nacimiento|date:"d/m/Y"|default:"No especificada" }}
                        </span>
                    </div>
                    <div class="profile-info-item">
                        <span class="profile-info-label">Fecha de Registro</span>
                        <span class="profile-info-value">{{ usuario.date_joined|date:"d/m/Y H:i" }}</span>
                    </div>
                    <div class="profile-info-item">
                        <span class="profile-info-label">Última Actualización</span>
                        <span class="profile-info-value">{{ perfil.fecha_actualizacion|date:"d/m/Y H:i" }}</span>
                    </div>
                </div>

                {% if perfil.biografia %}
                <div class="profile-bio">
                    <h3 class="profile-bio-title">Biografía</h3>
                    <p class="profile-bio-text">{{ perfil.biografia }}</p>
                </div>
                {% endif %}
            </div>

            <!-- Botón Volver -->
            <div class="d-flex gap-3 mb-4">
                <a href="{% url 'usuarios:lista_usuarios' %}" class="profile-action-btn btn-secondary">
                    <i class="bi bi-arrow-left"></i>
                    <span>Volver a la Lista</span>
                </a>
            </div>

        </div>
    </div>
</div>
{% endblock %}

